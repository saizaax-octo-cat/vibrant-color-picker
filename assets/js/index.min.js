let fileinput=document.getElementById("file-input"),canvas=document.getElementById("image-source"),ctx=canvas.getContext("2d");function loopPixels(e,t){let o=[];for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=getPixelColor(t,n);o.push(e)}colorCount(o)}function getPixelColor(e,t){let o=ctx.getImageData(e,t,1,1).data;return RGBToHex(o[0],o[1],o[2])}function colorCount(e){let t={};for(;0!=e.length;){let o=e[0],n=0;for(let t=0;t<e.length;t++)o==e[t]&&(n++,e.splice(t,1),t--);let a=hexToHSV(o)[0],l=hexToHSV(o)[1],r=hexToHSV(o)[2];t[o]={pixels:n,h:a,s:l,v:r}}colorSort(t)}function colorSort(e){let t=[];for(let o in e)t.push({[o]:e[o]});t.sort((e,t)=>e[Object.keys(e)].v<t[Object.keys(t)].v?1:-1),searchColor(0,t)}function searchColor(e,t){for(let o=0;o<t.length;o++){let n=t[o],a=Object.keys(n),l=n[a].s;if(n[a].v-l<=e)return setCSS(a[0])}searchColor(e+=5,t)}function setCSS(e){let t=hexToRGB(e)[0],o=hexToRGB(e)[1],n=hexToRGB(e)[2];$("body").css("background-color",e),$("#result-color").css("background-color",e),$("#result-color").css("box-shadow",`rgba(${t}, ${o}, ${n}, 0.35) 5px 5px 10px`),$("#image-source").css("box-shadow",`rgba(${t}, ${o}, ${n}, 0.35) 0px 15px 30px`),$("#input-color-hex").val(e.toUpperCase()),$("#input-color-rgb").val(`RGB(${t}, ${o}, ${n})`),$("#input-color-rgba").val(`RGBA(${t}, ${o}, ${n}, 1)`),setTimeout((function(){$("#image-source").removeClass("animated flip")}),3e3)}function RGBToHex(e,t,o){return e=e.toString(16),t=t.toString(16),o=o.toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),"#"+e+t+o}function hexToHSV(e){let t,o,n,a,l,r,c,i,s,h,g,u,x=0,d=0,f=0;return 4==e.length?(x="0x"+e[1]+e[1],d="0x"+e[2]+e[2],f="0x"+e[3]+e[3]):7==e.length&&(x="0x"+e[1]+e[2],d="0x"+e[3]+e[4],f="0x"+e[5]+e[6]),t=x/255,o=d/255,n=f/255,s=Math.max(t,o,n),h=s-Math.min(t,o,n),g=e=>(s-e)/6/h+.5,u=e=>Math.round(100*e)/100,0==h?c=i=0:(i=h/s,a=g(t),l=g(o),r=g(n),t===s?c=r-l:o===s?c=1/3+a-r:n===s&&(c=2/3+l-a),c<0?c+=1:c>1&&(c-=1)),[Math.floor(360*c),Math.floor(100*i),Math.floor(100*s)]}function hexToRGB(e){let t=0,o=0,n=0;return 4==e.length?(t="0x"+e[1]+e[1],o="0x"+e[2]+e[2],n="0x"+e[3]+e[3]):7==e.length&&(t="0x"+e[1]+e[2],o="0x"+e[3]+e[4],n="0x"+e[5]+e[6]),t=parseInt(t,16),o=parseInt(o,16),n=parseInt(n,16),[t,o,n]}canvas.height=200,canvas.width=200,fileinput.onchange=function(e){let t=new Image(canvas.width,canvas.height),o=e.target.files[0];if(void 0!==o)if(o.type.match("image.*")){let e=new FileReader;e.readAsDataURL(o),e.onload=function(e){e.target.readyState==FileReader.DONE&&(t.src=e.target.result,t.onload=()=>{ctx.drawImage(t,0,0,canvas.width,canvas.height);let e=!1;e||(e=!0,$("#image-source").css("border","none")),$("#image-source").addClass("animated flip"),loopPixels(canvas.width,canvas.height)})}}else alert("The provided file couldn't be uploaded as an image.")};